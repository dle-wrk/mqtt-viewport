<div class="container">
  <div class="connection-status">MQTT Connected</div>
  
  <div class="header">
    <h1>{{ title() }}</h1>
    <p>Real-time MQTT Response Monitoring Dashboard</p>
  </div>
  
  <div class="tracking-section">
    <h2 class="section-title">Response Tracking</h2>
    <table class="tracking-table">
      <thead>
        <tr>
          <th>Service</th>
          <th>Status</th>
          <th>Next Update</th>
          <th>Response Data</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of responseItems">
          <td class="item-name">{{ item.name }}</td>
          <td>
            <span [class]="item.status === 'Received' ? 'status status-received' : 'status status-waiting'">
              {{ item.status }}
            </span>
          </td>
          <td>
            <div class="timer" *ngIf="item.timer > 0">{{ item.timer }}s</div>
            <div *ngIf="item.timer === 0" class="timer" style="color: #ccc;">Standby</div>
          </td>
          <td>
            <div *ngIf="item.response; else noResponse" 
                 class="response-data" 
                 [class.highlight]="item.highlight">
              <div class="response-content">
                <div *ngFor="let key of objectKeys(item.response!.a)" class="response-row">
                  <strong>{{ key }}:</strong>
                  <ng-container *ngIf="item.response!.a[key] !== null; let value = item.response!.a[key]; else nullValue">
                    <ng-container *ngIf="isArray(value); else notArray">
                      {{ value.join(', ') }}
                    </ng-container>
                    <ng-template #notArray>
                      {{ value }}
                    </ng-template>
                  </ng-container>
                  <ng-template #nullValue>
                    <em>null</em>
                  </ng-template>
                </div>
              </div>
            </div>
            <ng-template #noResponse>
              <div class="no-response">Waiting for data...</div>
            </ng-template>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>